{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="gallery-page shop-page-card">
    <image class="userpic" src="{{ user.profile.image.url }}" 
></image>
 <!---->
<form method="POST" enctype="multipart/form-data"> <!--тип кодировки, для того что бы наша форма вставила правильные данные изображения, если забыть, форма не будет сохранять обновленное изображение--> 
    {% csrf_token %}
    <p><b>Profile info Update</b></p>
    {% if form.non_field_errors %}
    <div class="warning login-warning">{{form.non_field_errors}}</div> <!--альтернатива джанго мессаджес, выводит инфу о ошибке в поле, если она есть-->
    {% endif %}
    <div>
        <input type="text" class="" name="username"  
        value="{{ u_form.username.value }}" 
        id="id_username" placeholder="Username" required>
        <label for="{{ u_form.username.id_for_label }}" placeholder="Username">Change your name here</label>
    </div>
    <div>
        <input type="email" class="" name="email" value="{{ u_form.email.value }}" id="id_email" placeholder="Email" required>
        <label for="{{ u_form.email.id_for_label }}" placeholder="Email">Change your email</label>
    </div>
    <div>
        <input type="text" class="form-label" name="phone_number" value="{% if p_form.phone_number.value %}{{ p_form.phone_number.value }}{% endif %}"
        id="id_phone_number" placeholder="(000) 000-00-00" required>
        <label for="id_phone_number" class="form-label">Add or change your phone</label>
    </div>
    <div>
        <label for="image" placeholder="{{ p_form.image.id_for_label }}">Your avatar picture</label>
        <input type="file" name="image" 
        value="{{ p_form.image.value }}" 
        id="image" accept="image/png, image/jpeg, image/jpg, image/bmp, image/gif">
    </div>
    <p><button type="submit">Update</button></p>
</form>
<p>Not sure about your password?</p>
    <p><a href="{% url 'password_reset' %}">Reset password</a></p>
</div>
<div class="">
    <div class="" id="accordionExample">
        {% for order in orders %}
        <div class="">
            <h2 class="" id="heading{{ order.id }}">
                <button class="accordion-button {% if order != orders.0 %}collapsed{% endif %}" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ order.id }}" aria-expanded="false" aria-controls="collapse{{ order.id }}">
                    Order № {{ order.id }} - {{ order.created_timestamp }} | Satus: <strong class="">{{order.status}}</strong>
                </button>
            </h2>
            <div id="collapse{{ order.id }}" class="accordion-collapse collapse {% if order == orders.0 %}show{% endif %}" aria-labelledby="heading{{ order.id }}" data-bs-parent="#accordionExample">
                <div class="">
                    <table class="">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Price</th>
                                <th>Totall price</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in order.orderitem_set.all %}
                            <tr>
                                <td><a class="" href="{% url 'product' item.product.slug %}">{{ item.product.name }}</a></td>
                                <td>{{ item.quantity }}</td>
                                <td>{{ item.price }}</td>
                                <td>{{ item.products_price }}</td>
                                
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% include "carts/includes/included_cart.html" %}
<strong><a href="{% url 'create-order' %}">Place an order!</a></strong>
</div>
{% endblock content %}